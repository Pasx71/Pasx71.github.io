---
layout: none # Important: Prevents Jekyll from applying HTML layout
---
[
  {% assign items_to_index = "" | split: "," %} {% comment %}Initialize as empty array{% endcomment %}

  {% if site.posts.size > 0 %}
    {% assign items_to_index = items_to_index | concat: site.posts %}
  {% endif %}

  {% if site.collections.websites.size > 0 %}
    {% assign items_to_index = items_to_index | concat: site.collections.websites %}
  {% endif %}

  {% for item in items_to_index %}
    {
      "title": {{ item.title | jsonify }},
      "url": {% if item.collection == 'websites' %}{{ item.site_url | jsonify }}{% else %}{{ item.url | relative_url | jsonify }}{% endif %},
      "date": {% if item.date %}{{ item.date | date_to_string | jsonify }}{% else %}null{% endif %},
      "tags": {{ item.tags | jsonify }},
      "content": {{ item.content | strip_html | strip_newlines | normalize_whitespace | jsonify }},
      "description": {{ item.description | jsonify }}
    }{% unless forloop.last %},{% endunless %}
  {% endfor %}
]
